carracing_sac:
  agent_type: 'sac_ae'
  env_id: 'CarRacing-v0'
  env_wrappers: 
    - type: 'action_repeat'
      parameters:
        repeats: 3
    - type: 'resize' 
      parameters:
        shape: [64, 64]
    - type: 'frame_stack'
      parameters:
        num_stack: 3
        merge_stack: True
    - type: 'to_nchw'
    - type: 'rescale_action'
      parameters:
        a: [-1.0, -1.0, -1.0]
        b: [1.0, 1.0, 1.0]
  common:
    discount_factor: 0.99
    n_step: 1
    batch_size: 128
    reward_scaling: 1.0
    warm_up_steps: 10000
    polyak_factor: 0.01
    target_update_frequency: 1
    update_frequency: 1
    update_steps: 1
    seed: 1337
    log_path: 'output'
  specific:
    pi_learning_rate: 1.0e-3
    qv_learning_rate: 1.0e-3
    entropy_learning_rate: 1.0e-4
    encoder_learning_rate: 1.0e-3
    decoder_learning_rate: 1.0e-3
    latent_factor: 1.0e-6
    encoder_polyak: 0.05
    decoder_weight_decay: 1.0e-7
    policy_update_frequency: 1
  state_normalizer:
    type: 'image'
    parameters: null
  memory:
    capacity: 100000
    combined: False
    device: 'cuda'
  body:
    encoder:
      input:
        primary: [9, 64, 64]
      layers:
        - out_dim: 32
          activation: 'relu'
          layer_type: 'conv2d'
          kernel_size: 3
          stride: 2 
        - out_dim: 32
          activation: 'relu'
          layer_type: 'conv2d'
          kernel_size: 3
          stride: 2
        - out_dim: 32
          activation: 'relu'
          layer_type: 'conv2d'
          kernel_size: 3
          stride: 2 
        - out_dim: 32
          activation: 'relu'
          layer_type: 'conv2d'
          kernel_size: 3
          stride: 2 
        - layer_type: 'flatten'
          out_dim: 288
        - layer_type: 'linear'
          out_dim: 64
          activation: 'tanh'
          normalization: 'layer_norm'
    decoder:
      input:
        primary: 64
      layers:
        - layer_type: 'linear'
          out_dim: 288
          activation: 'relu'
        - layer_type: 'unflatten'
          unflattened_size: [32, 3, 3]
        - out_dim: 32
          activation: 'relu'
          layer_type: 'transpose_conv2d'
          kernel_size: 3
          stride: 2 
        - out_dim: 32
          activation: 'relu'
          layer_type: 'transpose_conv2d'
          kernel_size: 3
          stride: 2 
        - out_dim: 32
          activation: 'relu'
          layer_type: 'transpose_conv2d'
          kernel_size: 3
          stride: 2 
        - out_dim: 9
          activation: 'sigmoid'
          layer_type: 'transpose_conv2d'
          kernel_size: 3
          stride: 2 
          output_padding: 1
    actor:
      input:
        primary: 64
      layers:
        - out_dim: 512
          layer_type: 'linear'
          activation: 'relu'
        - out_dim: 512
          layer_type: 'linear'
          activation: 'relu'
    critic:
      input:
        primary: 64
        secondary: 3
      action_layer: 0
      layers:
        - out_dim: 512
          layer_type: 'linear'
          activation: 'relu'
        - out_dim: 512
          layer_type: 'linear'
          activation: 'relu'
